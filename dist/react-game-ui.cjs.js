"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("react");function r(e){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e)for(const t in e)if("default"!==t){const n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:()=>e[t]})}return r.default=e,Object.freeze(r)}const t=r(e);var n,o={exports:{}},a={};var i,l,s={};
/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function c(){return i||(i=1,"production"!==process.env.NODE_ENV&&function(){var r=e,t=Symbol.for("react.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),g=Symbol.iterator;var h=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function x(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];!function(e,r,t){var n=h.ReactDebugCurrentFrame.getStackAddendum();""!==n&&(r+="%s",t=t.concat([n]));var o=t.map(function(e){return String(e)});o.unshift("Warning: "+r),Function.prototype.apply.call(console[e],console,o)}("error",e,t)}var b;function k(e){return e.displayName||"Context"}function v(e){if(null==e)return null;if("number"==typeof e.tag&&x("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),"function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case o:return"Fragment";case n:return"Portal";case i:return"Profiler";case a:return"StrictMode";case p:return"Suspense";case f:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case c:return k(e)+".Consumer";case l:return k(e._context)+".Provider";case d:return function(e,r,t){var n=e.displayName;if(n)return n;var o=r.displayName||r.name||"";return""!==o?t+"("+o+")":t}(e,e.render,"ForwardRef");case u:var r=e.displayName||null;return null!==r?r:v(e.type)||"Memo";case m:var t=e,s=t._payload,y=t._init;try{return v(y(s))}catch(g){return null}}return null}b=Symbol.for("react.module.reference");var j,C,I,w,S,$,_,D=Object.assign,P=0;function R(){}R.__reactDisabledLog=!0;var O,T=h.ReactCurrentDispatcher;function N(e,r,t){if(void 0===O)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);O=n&&n[1]||""}return"\n"+O+e}var F,E=!1,z="function"==typeof WeakMap?WeakMap:Map;function W(e,r){if(!e||E)return"";var t,n=F.get(e);if(void 0!==n)return n;E=!0;var o,a=Error.prepareStackTrace;Error.prepareStackTrace=void 0,o=T.current,T.current=null,function(){if(0===P){j=console.log,C=console.info,I=console.warn,w=console.error,S=console.group,$=console.groupCollapsed,_=console.groupEnd;var e={configurable:!0,enumerable:!0,value:R,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}P++}();try{if(r){var i=function(){throw Error()};if(Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(i,[])}catch(m){t=m}Reflect.construct(e,[],i)}else{try{i.call()}catch(m){t=m}e.call(i.prototype)}}else{try{throw Error()}catch(m){t=m}e()}}catch(y){if(y&&t&&"string"==typeof y.stack){for(var l=y.stack.split("\n"),s=t.stack.split("\n"),c=l.length-1,d=s.length-1;c>=1&&d>=0&&l[c]!==s[d];)d--;for(;c>=1&&d>=0;c--,d--)if(l[c]!==s[d]){if(1!==c||1!==d)do{if(c--,--d<0||l[c]!==s[d]){var p="\n"+l[c].replace(" at new "," at ");return e.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",e.displayName)),"function"==typeof e&&F.set(e,p),p}}while(c>=1&&d>=0);break}}}finally{E=!1,T.current=o,function(){if(0===--P){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:D({},e,{value:j}),info:D({},e,{value:C}),warn:D({},e,{value:I}),error:D({},e,{value:w}),group:D({},e,{value:S}),groupCollapsed:D({},e,{value:$}),groupEnd:D({},e,{value:_})})}P<0&&x("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}(),Error.prepareStackTrace=a}var f=e?e.displayName||e.name:"",u=f?N(f):"";return"function"==typeof e&&F.set(e,u),u}function B(e,r,t){if(null==e)return"";if("function"==typeof e)return W(e,!(!(n=e.prototype)||!n.isReactComponent));var n;if("string"==typeof e)return N(e);switch(e){case p:return N("Suspense");case f:return N("SuspenseList")}if("object"==typeof e)switch(e.$$typeof){case d:return W(e.render,!1);case u:return B(e.type,r,t);case m:var o=e,a=o._payload,i=o._init;try{return B(i(a),r,t)}catch(l){}}return""}F=new z;var U=Object.prototype.hasOwnProperty,M={},L=h.ReactDebugCurrentFrame;function A(e){if(e){var r=e._owner,t=B(e.type,e._source,r?r.type:null);L.setExtraStackFrame(t)}else L.setExtraStackFrame(null)}var V=Array.isArray;function Y(e){return V(e)}function q(e){return""+e}function J(e){if(function(e){try{return q(e),!1}catch(r){return!0}}(e))return x("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",function(e){return"function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object"}(e)),q(e)}var K,X,H=h.ReactCurrentOwner,G={key:!0,ref:!0,__self:!0,__source:!0};function Q(e,r,n,o,a){var i,l={},s=null,c=null;for(i in void 0!==n&&(J(n),s=""+n),function(e){if(U.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return void 0!==e.key}(r)&&(J(r.key),s=""+r.key),function(e){if(U.call(e,"ref")){var r=Object.getOwnPropertyDescriptor(e,"ref").get;if(r&&r.isReactWarning)return!1}return void 0!==e.ref}(r)&&(c=r.ref,function(e){"string"==typeof e.ref&&H.current}(r)),r)U.call(r,i)&&!G.hasOwnProperty(i)&&(l[i]=r[i]);if(e&&e.defaultProps){var d=e.defaultProps;for(i in d)void 0===l[i]&&(l[i]=d[i])}if(s||c){var p="function"==typeof e?e.displayName||e.name||"Unknown":e;s&&function(e,r){var t=function(){K||(K=!0,x("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};t.isReactWarning=!0,Object.defineProperty(e,"key",{get:t,configurable:!0})}(l,p),c&&function(e,r){var t=function(){X||(X=!0,x("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};t.isReactWarning=!0,Object.defineProperty(e,"ref",{get:t,configurable:!0})}(l,p)}return function(e,r,n,o,a,i,l){var s={$$typeof:t,type:e,key:r,ref:n,props:l,_owner:i,_store:{}};return Object.defineProperty(s._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(s,"_self",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.defineProperty(s,"_source",{configurable:!1,enumerable:!1,writable:!1,value:a}),Object.freeze&&(Object.freeze(s.props),Object.freeze(s)),s}(e,s,c,a,o,H.current,l)}var Z,ee=h.ReactCurrentOwner,re=h.ReactDebugCurrentFrame;function te(e){if(e){var r=e._owner,t=B(e.type,e._source,r?r.type:null);re.setExtraStackFrame(t)}else re.setExtraStackFrame(null)}function ne(e){return"object"==typeof e&&null!==e&&e.$$typeof===t}function oe(){if(ee.current){var e=v(ee.current.type);if(e)return"\n\nCheck the render method of `"+e+"`."}return""}Z=!1;var ae={};function ie(e,r){if(e._store&&!e._store.validated&&null==e.key){e._store.validated=!0;var t=function(e){var r=oe();if(!r){var t="string"==typeof e?e:e.displayName||e.name;t&&(r="\n\nCheck the top-level render call using <"+t+">.")}return r}(r);if(!ae[t]){ae[t]=!0;var n="";e&&e._owner&&e._owner!==ee.current&&(n=" It was passed a child from "+v(e._owner.type)+"."),te(e),x('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',t,n),te(null)}}}function le(e,r){if("object"==typeof e)if(Y(e))for(var t=0;t<e.length;t++){var n=e[t];ne(n)&&ie(n,r)}else if(ne(e))e._store&&(e._store.validated=!0);else if(e){var o=function(e){if(null===e||"object"!=typeof e)return null;var r=g&&e[g]||e["@@iterator"];return"function"==typeof r?r:null}(e);if("function"==typeof o&&o!==e.entries)for(var a,i=o.call(e);!(a=i.next()).done;)ne(a.value)&&ie(a.value,r)}}function se(e){var r,t=e.type;if(null!=t&&"string"!=typeof t){if("function"==typeof t)r=t.propTypes;else{if("object"!=typeof t||t.$$typeof!==d&&t.$$typeof!==u)return;r=t.propTypes}if(r){var n=v(t);!function(e,r,t,n,o){var a=Function.call.bind(U);for(var i in e)if(a(e,i)){var l=void 0;try{if("function"!=typeof e[i]){var s=Error((n||"React class")+": "+t+" type `"+i+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[i]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw s.name="Invariant Violation",s}l=e[i](r,i,n,t,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(c){l=c}!l||l instanceof Error||(A(o),x("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",n||"React class",t,i,typeof l),A(null)),l instanceof Error&&!(l.message in M)&&(M[l.message]=!0,A(o),x("Failed %s type: %s",t,l.message),A(null))}}(r,e.props,"prop",n,e)}else if(void 0!==t.PropTypes&&!Z){Z=!0,x("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",v(t)||"Unknown")}"function"!=typeof t.getDefaultProps||t.getDefaultProps.isReactClassApproved||x("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}var ce={};function de(e,r,n,s,g,h){var k=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===i||e===a||e===p||e===f||e===y||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===u||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===b||void 0!==e.getModuleId)}(e);if(!k){var j="";(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(j+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var C;j+=oe(),null===e?C="null":Y(e)?C="array":void 0!==e&&e.$$typeof===t?(C="<"+(v(e.type)||"Unknown")+" />",j=" Did you accidentally export a JSX literal instead of a component?"):C=typeof e,x("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",C,j)}var I=Q(e,r,n,g,h);if(null==I)return I;if(k){var w=r.children;if(void 0!==w)if(s)if(Y(w)){for(var S=0;S<w.length;S++)le(w[S],e);Object.freeze&&Object.freeze(w)}else x("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else le(w,e)}if(U.call(r,"key")){var $=v(e),_=Object.keys(r).filter(function(e){return"key"!==e}),D=_.length>0?"{key: someKey, "+_.join(": ..., ")+": ...}":"{key: someKey}";if(!ce[$+D])x('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',D,$,_.length>0?"{"+_.join(": ..., ")+": ...}":"{}",$),ce[$+D]=!0}return e===o?function(e){for(var r=Object.keys(e.props),t=0;t<r.length;t++){var n=r[t];if("children"!==n&&"key"!==n){te(e),x("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",n),te(null);break}}null!==e.ref&&(te(e),x("Invalid attribute `ref` supplied to `React.Fragment`."),te(null))}(I):se(I),I}var pe=function(e,r,t){return de(e,r,t,!1)},fe=function(e,r,t){return de(e,r,t,!0)};s.Fragment=o,s.jsx=pe,s.jsxs=fe}()),s}var d=(l||(l=1,"production"===process.env.NODE_ENV?o.exports=function(){if(n)return a;n=1;var r=e,t=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,r,n){var o,a={},c=null,d=null;for(o in void 0!==n&&(c=""+n),void 0!==r.key&&(c=""+r.key),void 0!==r.ref&&(d=r.ref),r)i.call(r,o)&&!s.hasOwnProperty(o)&&(a[o]=r[o]);if(e&&e.defaultProps)for(o in r=e.defaultProps)void 0===a[o]&&(a[o]=r[o]);return{$$typeof:t,type:e,key:c,ref:d,props:a,_owner:l.current}}return a.Fragment=o,a.jsx=c,a.jsxs=c,a}():o.exports=c()),o.exports);const p="_boardContainer_1laip_8",f="_cell_1laip_28",u=({locationData:e,cellData:r,onClick:t,onDoubleClick:n,children:o,onDrop:a,onDragOver:i,changed:l=!1})=>{const s={backgroundColor:l?r.changedColor:r.backgroundColor};return d.jsx("div",{className:f,onClick:()=>{t(e)},onDoubleClick:()=>{n(e)},onDrop:a,onDragOver:i,style:s,children:o})},m={card:"_card_1mv54_3",tooltip:"_tooltip_1mv54_23",cardBack:"_cardBack_1mv54_47",deckContainer:"_deckContainer_1mv54_59",deckCard:"_deckCard_1mv54_66",deckCardFront:"_deckCardFront_1mv54_78",deckSection:"_deckSection_1mv54_95",discardPileWrapper:"_discardPileWrapper_1mv54_103",discardTopCard:"_discardTopCard_1mv54_109"},y=({card:e})=>e.isFaceUp?e.frontImage?d.jsx("img",{src:e.frontImage,alt:e.name,style:{width:"100%",height:"100%",objectFit:"contain"}}):(console.log(`[CardContent] pngの描画失敗: ${e.id}. Path: ${e.frontImage}`),d.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",padding:"5px"},children:d.jsx("strong",{style:{fontSize:"1em",wordBreak:"break-all",textAlign:"center"},children:e.name})})):null;const g={piece:"_piece_wi08l_3"};function h({piece:e,style:r,onClick:t,isDraggable:n,onDragStart:o}){const a=[g.piece,n?g.draggable:g.clickable].join(" ");return d.jsx("div",{className:a,style:{...r,backgroundColor:e.color},onClick:r=>{r.stopPropagation(),t(e.id)},draggable:n,onDragStart:r=>{n&&(r.stopPropagation(),r.dataTransfer.setData("text/plain",e.id),r.dataTransfer.effectAllowed="move",o(r,e))},title:e.name,children:e.name.substring(0,1)})}function x(e,...r){console.log(`[${e}]`,...r)}const b=({card:e,isFaceUp:r})=>r?e.frontImage?(console.log(`[CardDisplayContent] Card ID: ${e.id}, Name: ${e.name} - Rendering with frontImage: ${e.frontImage}`),d.jsx("img",{src:e.frontImage,alt:e.name,style:{width:"100%",height:"100%",objectFit:"contain"}})):(console.log(`[CardDisplayContent] Card ID: ${e.id}, Name: ${e.name} - Rendering with card.name (No frontImage).`),d.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",padding:"5px",color:"#333"},children:d.jsx("strong",{style:{fontSize:"0.8em",wordBreak:"break-all",textAlign:"center"},children:e.name})})):(console.log(`[CardDisplayContent] Card ID: ${e.id}, Name: ${e.name} - isFaceUp is false. Not rendering.`),null);const k=t.memo(({card:e,isFaceUp:r})=>r?e.frontImage?(console.log(`[CardDisplayContent] Card ID: ${e.id}, Name: ${e.name} - Rendering with frontImage: ${e.frontImage}`),d.jsx("img",{src:e.frontImage,alt:e.name,style:{width:"100%",height:"100%",objectFit:"contain"}})):(console.log(`[CardDisplayContent] Card ID: ${e.id}, Name: ${e.name} - Rendering with card.name (No frontImage).`),d.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",padding:"5px",color:"#333"},children:d.jsx("strong",{style:{fontSize:"0.8em",wordBreak:"break-all",textAlign:"center"},children:e.name})})):(console.log(`[CardDisplayContent] Card ID: ${e.id}, Name: ${e.name} - Not FaceUp. Rendering nothing.`),null)),v=t.memo(({tokens:e,socket:r,roomId:t,myPlayerId:n,playerIdBeingDisplayed:o})=>{const a=n===o;return e&&0!==e.length?d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #ddd"},children:e.map(e=>d.jsx("div",{title:a?`クリックして再獲得: ${e.name}`:e.name,style:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#fff",borderRadius:"50%",width:"48px",height:"48px",fontSize:"0.75em",fontWeight:"bold",boxShadow:"0 2px 5px rgba(0,0,0,0.2)",cursor:a?"pointer":"default",opacity:a?1:.7,flexShrink:0,padding:"2px"},onClick:()=>{a&&r.emit("token:reclaim",{roomId:t,playerId:n,tokenId:e.id})},children:e.name},e.id))}):null}),j=t.memo(({player:e,currentPlayerId:r,myPlayerId:t,selectedCards:n,toggleCardSelection:o,socket:a,roomId:i})=>d.jsxs("li",{style:{padding:"6px 12px",marginBottom:"6px",borderRadius:"4px",backgroundColor:e.id===r?"#a0e7ff":"#f5f5f5",fontWeight:e.id===r?"bold":"normal"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"1.1em",color:"#333"},children:[e.id===r&&"ᐅ ",e.id===t&&"★ ME ",e.name]}),d.jsxs("span",{style:{fontSize:"1.2em"},children:["スコア: ",e.score]})]}),e.resources?.length>0&&d.jsxs("div",{style:{marginTop:"4px",marginBottom:"8px",fontSize:"0.9em",color:"#333"},children:[d.jsx("strong",{style:{display:"block",marginBottom:"4px"},children:"リソース:"}),d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px"},children:e.resources.map(e=>d.jsxs("span",{title:e.name,style:{padding:"4px 8px",backgroundColor:"#f0f0f0",borderRadius:"4px",whiteSpace:"nowrap"},children:[e.icon," ",e.name,": ",e.currentValue," / ",e.maxValue]},e.id))})]}),e.tokens?.length>0&&d.jsx(v,{tokens:e.tokens,socket:a,roomId:i,myPlayerId:t,playerIdBeingDisplayed:e.id}),d.jsx("div",{style:{display:"flex",gap:"6px",marginTop:"6px",flexWrap:"wrap"},children:e.cards.map(r=>{const a=!!r.isFaceUp&&e.id===t,i=n.includes(r.id),l=a?m.card:m.cardBack;return console.log(`[PlayerListItem] Player: ${e.name}, Card ID: ${r.id}, Name: ${r.name} - isFaceUp: ${a}, Class: ${l}`),d.jsxs("div",{className:l,style:{position:"relative",cursor:a?"pointer":"default",backgroundColor:a?void 0:r.backColor,border:i?"2px solid gold":"none",boxSizing:"border-box",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>o(r.id,a),children:[d.jsx(k,{card:r,isFaceUp:a}),a&&r.description&&d.jsx("span",{className:m.tooltip,children:r.description})]},r.id)})})]},e.id));const C=e.memo(({token:e})=>e.imageSrc?d.jsx("img",{src:e.imageSrc,alt:e.name,style:{width:"100%",height:"100%",objectFit:"contain"}}):d.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",padding:"5px"},children:d.jsx("strong",{style:{fontSize:"1em",wordBreak:"break-all",textAlign:"center"},children:e.name})}));exports.Cell=u,exports.Deck=function({socket:e,roomId:r,deckId:n,name:o,playerId:a=null}){const[i,l]=t.useState([]),[s,c]=t.useState([]),[p,f]=t.useState([]),[u,g]=t.useState(!1);return t.useEffect(()=>(e.on(`deck:init:${r}:${n}`,e=>{l(e.currentDeck.map(e=>({...e,deckId:n}))),c(e.drawnCards.map(e=>({...e,deckId:n}))),f(e.discardPile.map(e=>({...e,deckId:n})))}),e.on(`deck:update:${r}:${n}`,e=>{console.log(`[Deck Update:${r}]`,e),l(e.currentDeck.map(e=>({...e,deckId:n}))),c(e.drawnCards.map(e=>({...e,deckId:n}))),f(e.discardPile.map(e=>({...e,deckId:n})))}),()=>{e.off(`deck:init:${r}:${n}`),e.off(`deck:update:${r}:${n}`)}),[e,r,n]),d.jsxs("section",{className:m.deckSection,children:[d.jsx("h3",{style:{marginBottom:"6px"},children:o}),d.jsxs("div",{className:m.deckControls,children:[d.jsx("button",{onClick:()=>e.emit("deck:shuffle",{roomId:r,deckId:n}),children:"シャッフル"}),d.jsx("button",{onClick:()=>e.emit("deck:reset",{roomId:r,deckId:n}),children:"山札に戻す"})]}),d.jsxs("div",{className:m.deckWrapper,style:{display:"flex",gap:"0px"},children:[d.jsx("div",{className:m.deckContainer,onClick:()=>{if(0===i.length)return;const t=i[0],o=t?.drawLocation||"hand",l={roomId:r,deckId:n,drawLocation:o};"hand"===o&&a&&(l.playerId=a),e.emit("deck:draw",l)},children:i.map((e,r)=>d.jsx("div",{className:m.deckCard,style:{zIndex:i.length-r,transform:`translate(${.3*r}px, ${.3*r}px)`,backgroundColor:e.backColor}},e.id))}),d.jsx("div",{className:m.deckContainer,children:s.map((e,r)=>d.jsx("div",{className:m.deckCardFront,style:{zIndex:r+1,transform:`translate(${.3*r}px, ${.3*r}px)`},children:d.jsx(y,{card:e})},e.id))}),d.jsx("div",{className:`${m.deckContainer} ${m.discardPileWrapper}`,children:p.length>0&&(()=>{const e=p[p.length-1];return d.jsxs("div",{className:`${m.deckCardFront} ${m.discardTopCard}`,style:{pointerEvents:"auto"},onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[d.jsx(y,{card:e}),e.description&&d.jsx("span",{className:m.tooltip,style:{visibility:u?"visible":"hidden",opacity:u?1:0,zIndex:9999},children:e.description})]},e.id)})()})]})]})},exports.Dice=function({sides:r=6,socket:t=null,diceId:n,roomId:o,onRoll:a}){const[i,l]=e.useState(null),[s,c]=e.useState(!1),p=e.useRef(null),f=e.useMemo(()=>`dice:rolled:${o}:${n}`,[o,n]);e.useEffect(()=>{if(!t||!o)return;const e=e=>{c(!0);let t=0;p.current=setInterval(()=>{const n=Math.floor(Math.random()*r)+1;l(n),t++,t>=20&&(clearInterval(p.current),p.current=null,l(e),c(!1),a?.(e))},50)};return t.on(f,e),()=>{t.off(f,e),p.current&&clearInterval(p.current)}},[t,r,n,o,a,f]);const u={width:"80px",height:"80px",border:"2px solid #333",borderRadius:"8px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontSize:"2rem",fontWeight:"bold",cursor:s?"not-allowed":"pointer",userSelect:"none",backgroundColor:s?"#ffeaa7":"#fff",color:"#333",boxShadow:s?"0 0 15px rgba(255, 107, 107, 0.7)":"0 4px 6px rgba(0,0,0,0.3)",transition:"all 0.2s",fontFamily:"Inter, sans-serif"};return d.jsxs("div",{style:u,onClick:()=>{t&&!s&&t.emit("dice:roll",{roomId:o,diceId:n,sides:r})},children:[d.jsx("span",{style:{fontSize:"1em"},children:i??"🎲"}),d.jsx("span",{style:{fontSize:"0.5rem",color:"#666"},children:n})]})},exports.GridBoard=function({rows:e,cols:r,boardData:t,pieces:n,changedCells:o,renderCell:a,onCellClick:i,onCellDoubleClick:l,onPieceClick:s,allowPieceDrag:c=!1,onPieceDragStart:f,onCellDrop:m}){const y=e=>{const r=t[e.row][e.col];i(r,e)},g=e=>{const r=t[e.row][e.col];l(r,e)},x={"--board-rows":e,"--board-cols":r,display:"grid",gridTemplateRows:`repeat(${e}, 1fr)`,gridTemplateColumns:`repeat(${r}, 1fr)`,gap:"4px",width:"600px",height:"600px",position:"relative"};return d.jsxs("div",{className:p,style:x,children:[t.map((e,r)=>e.map((e,t)=>{const n=o.some(e=>e.row===r&&e.col===t),i=n?e.changedContent:e.content,l={...e,content:i},s={row:r,col:t};return d.jsx(u,{locationData:s,cellData:l,onClick:y,onDoubleClick:g,onDrop:e=>m(e,r,t),onDragOver:e=>e.preventDefault(),changed:n,children:a(l,r,t)},e.id)})),n.map(e=>{const r=n.filter(r=>r.location.row===e.location.row&&r.location.col===e.location.col),t=r.findIndex(r=>r.id===e.id),o=r.length;let a=0,i=0;if(o>1){const e=18,r=2*Math.PI/o*t;a=e*Math.cos(r),i=e*Math.sin(r)}const l={gridArea:`${e.location.row+1} / ${e.location.col+1} / span 1 / span 1`,alignSelf:"center",justifySelf:"center",transform:`translate(${a}px, ${i}px)`,transition:"transform 0.3s ease-in-out"};return d.jsx(h,{piece:e,style:l,onClick:s,isDraggable:c,onDragStart:r=>((e,r)=>{f(e,r)})(r,e)},e.id)})]})},exports.PlayField=function({socket:e,roomId:r,deckId:n,name:o,is_logging:a=!1,players:i,myPlayerId:l}){const[s,c]=t.useState([]);return t.useEffect(()=>{const t=e=>{const r=e.playFieldCards||[];a&&(x("playField",`[${n}] 場の状態を更新`),x("playField",`[${n}] 古いカード数: ${s.length}, 新しいカード数: ${r.length}`),x("playField",`[${n}] 受信したカードリスト:`,r.map(e=>e.name))),console.log(`[PlayField] Deck ${n} - Received ${r.length} cards for rendering.`),c(r)};return e.on(`deck:update:${r}:${n}`,t),()=>{e.off(`deck:update:${r}:${n}`,t)}},[e,r,n,s.length]),console.log(`[PlayField] Deck ${n} - Start rendering ${s.length} cards in the Play Area.`),d.jsxs("section",{style:{border:"2px dashed #ccc",borderRadius:"10px",padding:"12px",background:"#fafafa"},children:[d.jsxs("h3",{style:{marginBottom:"8px"},children:["プレイエリア",o&&d.jsxs("span",{style:{marginLeft:"10px",fontWeight:"normal",fontSize:"0.9em",color:"#666"},children:["（",o,"）"]})]}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",minHeight:"120px"},children:[0===s.length&&d.jsx("div",{style:{opacity:.6},children:"（まだカードが出ていません）"}),s.map(t=>{const o=(a=t.ownerId)?a===l?"#4fc3f7":"#242a2aff":"#aaaaaa";var a;const s=t.ownerId?i.find(e=>e.id===t.ownerId):null,c=s?.name?.[0]||"?";return console.log(`[PlayField] Deck ${n} - Rendering Card ID: ${t.id}, Name: ${t.name} (Owner: ${t.ownerId}, Color: ${o})`),d.jsxs("div",{className:m.card,style:{cursor:"pointer",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},onDoubleClick:()=>(t=>{t.ownerId?(e.emit("card:return-to-hand",{roomId:r,deckId:t.deckId,cardId:t.id,targetPlayerId:t.ownerId}),x("playField",`カード ${t.name} を持ち主 ${t.ownerId} の手札に戻すようリクエスト`)):x("playField",`警告: ${t.name} には所有者IDが設定されていません。手札に戻せません。`)})(t),children:[d.jsx(b,{card:t,isFaceUp:!0}),t.ownerId&&d.jsx("div",{title:`所有者: ${s?.name||"不明"}`,style:{position:"absolute",top:"-5px",right:"-5px",width:"18px",height:"18px",borderRadius:"50%",backgroundColor:o,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold",color:"white",border:"2px solid white",boxShadow:"0 0 5px rgba(0, 0, 0, 0.5)",zIndex:10},children:c}),t.description&&d.jsx("span",{className:m.tooltip,children:t.description})]},t.id)})]})]})},exports.ScoreBoard=function({socket:e,players:r,currentPlayerId:n,myPlayerId:o,roomId:a,backColor:i="#000000ff"}){const l=t.useMemo(()=>(r||[]).map(e=>({...e,score:e.score??0,cards:e.cards??[],resources:e.resources??[],tokens:e.tokens??[]})),[r]),[s,c]=t.useState([]),p=t.useCallback((e,r)=>{r&&c(r=>r.includes(e)?r.filter(r=>r!==e):[...r,e])},[]),f=t.useCallback(()=>{if(0===s.length||!o)return;const r=l.find(e=>e.id===o);if(!r)return;const t={};let n;s.forEach(e=>{const o=r.cards.find(r=>r.id===e);o&&(n||(n=o.playLocation),t[o.deckId]||(t[o.deckId]=[]),t[o.deckId].push(o.id))}),n&&(Object.entries(t).forEach(([r,t])=>{e.emit("card:play",{roomId:a,deckId:r,cardIds:t,playerId:o,playLocation:n})}),c([]))},[s,o,l,e,a]),u=t.useCallback(()=>{e.emit("game:next-turn",{roomId:a})},[e,a]);return d.jsxs("div",{style:{padding:"16px",border:"1px solid #333",borderRadius:"12px",backgroundColor:"#f9f9f9",maxWidth:"900px",margin:"0 auto",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[d.jsx("h2",{style:{fontSize:"1.5em",marginBottom:"12px",borderBottom:"2px solid #ddd",paddingBottom:"8px"},children:"ゲームスコアボード"}),d.jsx("ul",{style:{listStyle:"none",padding:0},children:l.map(r=>d.jsx(j,{player:r,currentPlayerId:n,myPlayerId:o,selectedCards:s,toggleCardSelection:p,socket:e,roomId:a},r.id))}),d.jsxs("div",{style:{marginTop:"12px",display:"flex",gap:"6px"},children:[d.jsx("button",{onClick:f,disabled:0===s.length,children:"選択カードを出す"}),d.jsx("button",{onClick:u,children:"次のターン"})]})]})},exports.Timer=function({socket:r=null,onFinish:t,roomId:n}){const[o,a]=e.useState(null);return e.useEffect(()=>{if(!r||!n)return;const e=e=>{e.roomId===n&&a(e.duration)},o=e=>{e.roomId===n&&(a(e.remaining),e.remaining<=0&&t?.())};return r.on("timer:start",e),r.on("timer:update",o),()=>{r.off("timer:start",e),r.off("timer:update",o)}},[r,n,t]),d.jsxs("div",{style:{width:"300px",height:"80px",border:"2px solid #333",borderRadius:"8px",padding:"8px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#f9f9f9",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",fontFamily:"sans-serif"},children:[d.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:null!==o?o<=6?"red":o<=15?"orange":"green":"gray",transition:"color 0.5s ease"},children:["残り時間: ",o??"-","s"]}),d.jsx("div",{style:{marginTop:"6px"},children:d.jsx("button",{onClick:()=>{r&&n&&r.emit("timer:start",{duration:30,roomId:n})},style:{marginRight:"4px"},children:"開始"})})]})},exports.TokenStore=function({socket:r,roomId:t,tokenStoreId:n,name:o,onSelect:a}){const[i,l]=e.useState([]),[s,c]=e.useState(null),p=e.useCallback(e=>{console.log(`TokenStore (${n}): 初期情報を受信しました。`,e),l(e&&e.length>0?e:[])},[n]),f=e.useCallback(e=>{console.log(`TokenStore (${n}): 更新情報を受信しました。`,e),l(e||[])},[n]);e.useEffect(()=>{if(!r)return void console.warn("TokenStore: Socket connection is not available. UI remains empty.");const e=`token-store:init:${t}:${n}`,o=`token-store:update:${t}:${n}`;return r.on(e,p),r.on(o,f),console.log(`TokenStore (${n}): リスナーを登録しました。`),()=>{r.off(e,p),r.off(o,f),console.log(`TokenStore (${n}): リスナーを解除しました。`)}},[r,t,n,p,f]);const u=e.useMemo(()=>e=>i.find(r=>r.id===e),[i]),m="40px";return d.jsxs("section",{style:{backgroundColor:"#dededeff",padding:"10px",margin:"15px",borderRadius:"10px",boxShadow:"0 4px 10px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{marginBottom:"10px",color:"#333"},children:o}),d.jsx("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:i.map(e=>d.jsx("div",{onClick:()=>(e=>{const r=u(e);r&&(c(e),a?.(r))})(e.id),onDoubleClick:()=>(e=>{const o=u(e);if(!o)return;const a={roomId:t,tokenStoreId:n,tokenId:e,tokenName:o.name};console.log("[TokenStore] ダブルクリック: トークン獲得イベント 'game:acquire-token' を送信",a),r.emit("game:acquire-token",a),c(null)})(e.id),style:{padding:"8px",width:m,height:m,borderRadius:"50%",border:s===e.id?"2px solid #f6fbd1ff":"2px solid #ccc",backgroundColor:"#4f4848ff",cursor:"pointer",textAlign:"center",display:"flex",flexDirection:"column",justifyContent:"space-around",alignItems:"center",boxShadow:"0 4px 8px rgba(0,0,0,0.2)"},children:d.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsx(C,{token:e})})},e.id))})]})};
